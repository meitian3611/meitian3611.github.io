---
title: 微信小程序
date: 2020-01-09 21:06:38
tags:
	- 前端
	- 组件
	- API
categories: 小程序
---

详细文档请参考官网   [文档链接]( https://developers.weixin.qq.com/miniprogram/dev/framework/ )

## 一，基本语法

### 数据绑定 

1. 在开始标签与结束标签中绑定直接使用 双花括号
2. 绑定属性仍然使用双花括号

### 列表渲染 

> wx:for

1. 默认情况下，循环的每一项是使用 item 来接收的。如果需要修改使用 wx:for-item="xxx"

2. 默认情况下，循环的每一项的下标是 index 来接收的。如果需要修改使用 wx:for-index="yyy

3. 需要提供 wx:key，如果数据由唯一值，例如id，那么直接设置 wx:key 为这个属性的名字，如果没有唯一值，则设置为 *this 即可

```html
  <view wx:for="{{list}}" wx:for-item="abc" wx:key="id">
    <text>{{abc.name}} - {{index}}</text>
  </view>
```

### 条件渲染

> wx:if ----- wx:else ------ wx:elif 

1. 小程序中没有wx:show，但有一个作用相反的公共 hidden 属性
2. wx:if 和 hidden 的区别
   1. wx:if 才是真真的条件渲染，而 hidden 只是简单的控制 display style
   2. wx:if 有配套的 wx:else wx:elif， 而 hidden 没有
   3. wx:if 可以配合 block 使用，而 hidden 不可以
   4. wx:if 有更高的切换开销，hidden 有更高的初始渲染开销
   5. 频繁切换使用 hidden。否则使用 wx:if

### 模板

> WXML提供模板（template），可以在模板中定义代码片段，然后在不同的地方调用

1. 定义模板, 要设置 name 属性

   ```html
   <template name="xxx">hello</template>
   ```

2. 使用模板，要设置 is 属性

   ```html
   <template is="xxx"></template>
   ```

3. 引入在别的 wxml 中定义的模板，需要使用 import 标签

   ```html
   <import src="xxx.wxml" />
   ```

4. 使用模板时，可以设置 data 属性来给模板传递参数增加模板的复用性

   ```html
   <!-- 模板文件 -->
   <template name="demo">
       <view>demo ---- {{ name }} - {{ age }}</view>
   </template>
   <!-- 引入模板文件 -->
   <import src="/templates/demo.wxml" />
   <template is="demo" data="{{msg:'张三', age:20}}"></template>
   ```

### 引用

> wxml中提供了两个标签可以去引入别的 wxml 中的内容

1. import 只能用于引入 template 模板
2. include 只能用于引入wxml 中的视图，不能引入template内容

## 二，生命周期

> 在小程序中，含有两种生命周期，APP生命周期，Page生命周期
>
> 通俗来说就是全局的生命周期和当前页面的生命周期

### App

- onLaunch		小程序的初始化，每次加载小程序只执行一次
- onShow           监听小程序的显示
- onHide            监听小程序的隐藏

### Page

- onLoad		   监听页面的加载，初次进入当前页面就会执行
- onShow          监听页面的显示，每次进入当前页面都会执行
- onReady         监听页面的渲染完成，初次进入当前页面就会执行
- onHide           监听页面的隐藏，每次离开当前页面都会执行
- onUnload      监听页面的卸载，只有当前页面被**重定向**或**关闭**才会执行
  - wx.redirectTo	  || 	navigator	open-type="redirect"
  - wx.navigateBack ||    navigator    open-type="navigateBack"

```js
// 重定向后，没有返回上一级按钮，页面已经被卸载，再次打开需要执行 onLoad  onReady

<navigator url="/pages/demo/demo" open-type="redirectTo">重定向页面</navigator>
```

```js
<button bindtap="handleClick">重定向</button>
// 
  handleClick(){
    wx.redirectTo({
      url: '/pages/demo/demo',
    })}
```

### 执行顺序

第一次打开小程序

> onLaunch  =>  App onShow  =>  Page onLoad  => Page onShow  => Page onReady

切换到后台

> Page onHide  =>  App onHide

切换回小程序界面

> App onShow  =>  Page onShow

## 多页面共享数据

1. 使用小程序的本地存储  ---  storage
2. 在 App 中定义，然后其它页面通过 getApp() 函数获取数据实现多页面共享

```js
// APP.js
App({
    globalData: {
    name: '张三'
  }})
// demo.js
Page({
    data:{
       name: getApp().globalData.name
  }})
```

